async function findStopId(route, direction) {
    try {
        document.getElementById('status').textContent = 'Finding Yip Yee Mansion stop...';
        const res = await fetch(`${BASE_URL}route-stop/${COMPANY}/${route}/${direction}`);
        const data = await res.json();
        if (!data.data || data.data.length === 0) {
            console.log(`No stops returned for ${route} ${direction}`);
            return null;
        }

        // More flexible search: ignore case, trim spaces, look for key words
        const targetEn = 'yip yee mansion'.toLowerCase();
        const targetTc = '業漁大廈'.toLowerCase();

        const stop = data.data.find(s => {
            const en = (s.name_en || '').toLowerCase().trim();
            const tc = (s.name_tc || '').toLowerCase().trim();
            return en.includes(targetEn) || tc.includes(targetTc) ||
                   en.includes('yip yee') || tc.includes('業漁');
        });

        if (stop) {
            console.log('Found stop:', stop.name_en, stop.name_tc, 'ID:', stop.stop);
            return stop.stop;
        } else {
            console.log('No matching stop found. Sample stops:', data.data.slice(0,3).map(s => s.name_en || s.name_tc));
            return null;
        }
    } catch (err) {
        console.error('Fetch error:', err);
        return null;
    }
}
